{"ast":null,"code":"import{useEffect,useState}from\"react\";import{useSearchParams}from\"react-router-dom\";import{getAddress,getCart,orderCheckout,orderSummary}from\"../utils/apiCalls\";import ConfirmPayment from\"../components/checkout/ConfirmPayment\";import BillingDetails from\"../components/checkout/BillingDetails\";import{Box}from\"@mui/material\";import SummaryOrderProductCard from\"../components/checkout/SummaryOrderProductCard\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Checkout(){console.log(\"Checkout component rendered\");const[searchParams,setSearchParams]=useSearchParams();const[payemntMethod,setPaymentMethod]=useState(searchParams.get(\"paymentMethod\")||\"cash\");const[promoCode,setPromoCode]=useState(searchParams.get(\"promocode\")||\"\");const[addressActive,setAddressActive]=useState(null);const[cart,setCart]=useState([]);const[order,setOrder]=useState([]);const[address,setAddress]=useState([]);const[DataSubmit,setDataSubmit]=useState();const[phone,setPhone]=useState(\"\");const[ForceReload,setForceReload]=useState(false);const[isUseWallet,setIsUseWallet]=useState(searchParams.get(\"useWallet\")||false);useEffect(()=>{const fetchCart=async()=>{const cartData=await getCart();setCart(cartData);};const fetchAddress=async()=>{var _addressData$items,_addressData$items2,_addressData$items3,_addressData$items3$;const addressData=await getAddress();setAddress(addressData);setAddressActive(addressData!==null&&addressData!==void 0&&(_addressData$items=addressData.items)!==null&&_addressData$items!==void 0&&_addressData$items.length?(addressData===null||addressData===void 0?void 0:(_addressData$items2=addressData.items)===null||_addressData$items2===void 0?void 0:_addressData$items2.filter(item=>item===null||item===void 0?void 0:item.primary).id)||(addressData===null||addressData===void 0?void 0:(_addressData$items3=addressData.items)===null||_addressData$items3===void 0?void 0:(_addressData$items3$=_addressData$items3[0])===null||_addressData$items3$===void 0?void 0:_addressData$items3$.id):null);};fetchCart();fetchAddress();},[ForceReload]);useEffect(()=>{if(!searchParams.get(\"paymentMethod\")){setSearchParams(prev=>{prev.set(\"paymentMethod\",\"Cash on Delivery\");return prev;});}},[]);useEffect(()=>{var _address$items,_address$items$;const data={promocode:promoCode,useWallet:isUseWallet,paymentMethod:searchParams.get(\"paymentMethod\"),address:address===null||address===void 0?void 0:(_address$items=address.items)===null||_address$items===void 0?void 0:(_address$items$=_address$items[0])===null||_address$items$===void 0?void 0:_address$items$.id,phone:phone};setDataSubmit(data);},[address===null||address===void 0?void 0:address.items,payemntMethod,promoCode,searchParams,phone,isUseWallet]);useEffect(()=>{var _address$items2,_address$items2$;const data={promocode:promoCode,useWallet:isUseWallet,paymentMethod:searchParams.get(\"paymentMethod\"),address:address===null||address===void 0?void 0:(_address$items2=address.items)===null||_address$items2===void 0?void 0:(_address$items2$=_address$items2[0])===null||_address$items2$===void 0?void 0:_address$items2$.id,phone:phone};setDataSubmit(data);const fetchOrder=async()=>{const orderData=await orderSummary(data);setOrder(orderData);};fetchOrder();},[address===null||address===void 0?void 0:address.items,payemntMethod,promoCode,searchParams,isUseWallet]);return/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:\"52px\",justifyContent:\"center\",flexWrap:\"wrap\",background:\"#FAFAFA\",paddingTop:\"50px\",paddingBottom:\"100px\"},className:\"padding-container\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"column\",gap:\"24px\",flex:3},children:[/*#__PURE__*/_jsx(\"h1\",{style:{fontSize:\"24px\",fontWeight:\"500\"},children:\"Summary Order\"}),/*#__PURE__*/_jsxs(Box,{sx:{backgroundColor:\"#fff\",padding:\"24px\",borderRadius:\"12px\"},children:[\" \",cart===null||cart===void 0?void 0:cart.map(item=>/*#__PURE__*/_jsx(SummaryOrderProductCard,{item:item},item.id))]}),/*#__PURE__*/_jsx(BillingDetails,{address:address,addressActive:addressActive,setAddressActive:setAddressActive,phone:phone,setPhone:setPhone,ForceReload:ForceReload,setForceReload:setForceReload})]}),/*#__PURE__*/_jsx(ConfirmPayment,{address:address,addressActive:addressActive,orderSummary:order,promoCodeMain:promoCode,setPromoCodeMain:setPromoCode,isUseWallet:isUseWallet,DataSubmit:DataSubmit,setIsUseWallet:setIsUseWallet})]});}","map":{"version":3,"names":["useEffect","useState","useSearchParams","getAddress","getCart","orderCheckout","orderSummary","ConfirmPayment","BillingDetails","Box","SummaryOrderProductCard","jsx","_jsx","jsxs","_jsxs","Checkout","console","log","searchParams","setSearchParams","payemntMethod","setPaymentMethod","get","promoCode","setPromoCode","addressActive","setAddressActive","cart","setCart","order","setOrder","address","setAddress","DataSubmit","setDataSubmit","phone","setPhone","ForceReload","setForceReload","isUseWallet","setIsUseWallet","fetchCart","cartData","fetchAddress","_addressData$items","_addressData$items2","_addressData$items3","_addressData$items3$","addressData","items","length","filter","item","primary","id","prev","set","_address$items","_address$items$","data","promocode","useWallet","paymentMethod","_address$items2","_address$items2$","fetchOrder","orderData","style","display","gap","justifyContent","flexWrap","background","paddingTop","paddingBottom","className","children","flexDirection","flex","fontSize","fontWeight","sx","backgroundColor","padding","borderRadius","map","promoCodeMain","setPromoCodeMain"],"sources":["/var/www/production/portal/src/pages/Checkout.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useSearchParams } from \"react-router-dom\";\n\nimport {\n  getAddress,\n  getCart,\n  orderCheckout,\n  orderSummary,\n} from \"../utils/apiCalls\";\nimport ConfirmPayment from \"../components/checkout/ConfirmPayment\";\nimport BillingDetails from \"../components/checkout/BillingDetails\";\nimport { Box } from \"@mui/material\";\nimport SummaryOrderProductCard from \"../components/checkout/SummaryOrderProductCard\";\nexport default function Checkout() {\n  console.log(\"Checkout component rendered\");\n\n  const [searchParams, setSearchParams] = useSearchParams();\n  const [payemntMethod, setPaymentMethod] = useState(\n    searchParams.get(\"paymentMethod\") || \"cash\"\n  );\n  const [promoCode, setPromoCode] = useState(\n    searchParams.get(\"promocode\") || \"\"\n  );\n  const [addressActive, setAddressActive] = useState(null);\n\n  const [cart, setCart] = useState([]);\n  const [order, setOrder] = useState([]);\n  const [address, setAddress] = useState([]);\n  const [DataSubmit, setDataSubmit] = useState();\n  const [phone, setPhone] = useState(\"\");\n  const [ForceReload, setForceReload] = useState(false);\n  const [isUseWallet, setIsUseWallet] = useState(\n    searchParams.get(\"useWallet\") || false\n  );\n  useEffect(() => {\n    const fetchCart = async () => {\n      const cartData = await getCart();\n      setCart(cartData);\n    };\n\n    const fetchAddress = async () => {\n      const addressData = await getAddress();\n      setAddress(addressData);\n      setAddressActive(\n        addressData?.items?.length\n          ? addressData?.items?.filter((item) => item?.primary).id ||\n              addressData?.items?.[0]?.id\n          : null\n      );\n    };\n\n    fetchCart();\n    fetchAddress();\n  }, [ForceReload]);\n\n  useEffect(() => {\n    if (!searchParams.get(\"paymentMethod\")) {\n      setSearchParams((prev) => {\n        prev.set(\"paymentMethod\", \"Cash on Delivery\");\n        return prev;\n      });\n    }\n  }, []);\n\n  useEffect(() => {\n    const data = {\n      promocode: promoCode,\n      useWallet: isUseWallet,\n      paymentMethod: searchParams.get(\"paymentMethod\"),\n      address: address?.items?.[0]?.id,\n      phone: phone,\n    };\n    setDataSubmit(data);\n  }, [\n    address?.items,\n    payemntMethod,\n    promoCode,\n    searchParams,\n    phone,\n    isUseWallet,\n  ]);\n\n  useEffect(() => {\n    const data = {\n      promocode: promoCode,\n      useWallet: isUseWallet,\n      paymentMethod: searchParams.get(\"paymentMethod\"),\n      address: address?.items?.[0]?.id,\n      phone: phone,\n    };\n    setDataSubmit(data);\n    const fetchOrder = async () => {\n      const orderData = await orderSummary(data);\n      setOrder(orderData);\n    };\n    fetchOrder();\n  }, [address?.items, payemntMethod, promoCode, searchParams, isUseWallet]);\n\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        gap: \"52px\",\n        justifyContent: \"center\",\n        flexWrap: \"wrap\",\n        background: \"#FAFAFA\",\n        paddingTop: \"50px\",\n        paddingBottom: \"100px\",\n      }}\n      className=\"padding-container\"\n    >\n      <div\n        style={{\n          display: \"flex\",\n          flexDirection: \"column\",\n          gap: \"24px\",\n          flex: 3,\n        }}\n      >\n        <h1 style={{ fontSize: \"24px\", fontWeight: \"500\" }}>Summary Order</h1>\n\n        <Box\n          sx={{\n            backgroundColor: \"#fff\",\n            padding: \"24px\",\n            borderRadius: \"12px\",\n          }}\n        >\n          {\" \"}\n          {cart?.map((item) => (\n            <SummaryOrderProductCard item={item} key={item.id} />\n          ))}\n        </Box>\n        <BillingDetails\n          address={address}\n          addressActive={addressActive}\n          setAddressActive={setAddressActive}\n          phone={phone}\n          setPhone={setPhone}\n          ForceReload={ForceReload}\n          setForceReload={setForceReload}\n        />\n      </div>\n\n      <ConfirmPayment\n        address={address}\n        addressActive={addressActive}\n        orderSummary={order}\n        promoCodeMain={promoCode}\n        setPromoCodeMain={setPromoCode}\n        isUseWallet={isUseWallet}\n        DataSubmit={DataSubmit}\n        setIsUseWallet={setIsUseWallet}\n      />\n    </div>\n  );\n}\n"],"mappings":"AAAA,OAASA,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,OAASC,eAAe,KAAQ,kBAAkB,CAElD,OACEC,UAAU,CACVC,OAAO,CACPC,aAAa,CACbC,YAAY,KACP,mBAAmB,CAC1B,MAAO,CAAAC,cAAc,KAAM,uCAAuC,CAClE,MAAO,CAAAC,cAAc,KAAM,uCAAuC,CAClE,OAASC,GAAG,KAAQ,eAAe,CACnC,MAAO,CAAAC,uBAAuB,KAAM,gDAAgD,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBACrF,cAAe,SAAS,CAAAC,QAAQA,CAAA,CAAG,CACjCC,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAC,CAE1C,KAAM,CAACC,YAAY,CAAEC,eAAe,CAAC,CAAGjB,eAAe,CAAC,CAAC,CACzD,KAAM,CAACkB,aAAa,CAAEC,gBAAgB,CAAC,CAAGpB,QAAQ,CAChDiB,YAAY,CAACI,GAAG,CAAC,eAAe,CAAC,EAAI,MACvC,CAAC,CACD,KAAM,CAACC,SAAS,CAAEC,YAAY,CAAC,CAAGvB,QAAQ,CACxCiB,YAAY,CAACI,GAAG,CAAC,WAAW,CAAC,EAAI,EACnC,CAAC,CACD,KAAM,CAACG,aAAa,CAAEC,gBAAgB,CAAC,CAAGzB,QAAQ,CAAC,IAAI,CAAC,CAExD,KAAM,CAAC0B,IAAI,CAAEC,OAAO,CAAC,CAAG3B,QAAQ,CAAC,EAAE,CAAC,CACpC,KAAM,CAAC4B,KAAK,CAAEC,QAAQ,CAAC,CAAG7B,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAAC8B,OAAO,CAAEC,UAAU,CAAC,CAAG/B,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAACgC,UAAU,CAAEC,aAAa,CAAC,CAAGjC,QAAQ,CAAC,CAAC,CAC9C,KAAM,CAACkC,KAAK,CAAEC,QAAQ,CAAC,CAAGnC,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACoC,WAAW,CAAEC,cAAc,CAAC,CAAGrC,QAAQ,CAAC,KAAK,CAAC,CACrD,KAAM,CAACsC,WAAW,CAAEC,cAAc,CAAC,CAAGvC,QAAQ,CAC5CiB,YAAY,CAACI,GAAG,CAAC,WAAW,CAAC,EAAI,KACnC,CAAC,CACDtB,SAAS,CAAC,IAAM,CACd,KAAM,CAAAyC,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5B,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAtC,OAAO,CAAC,CAAC,CAChCwB,OAAO,CAACc,QAAQ,CAAC,CACnB,CAAC,CAED,KAAM,CAAAC,YAAY,CAAG,KAAAA,CAAA,GAAY,KAAAC,kBAAA,CAAAC,mBAAA,CAAAC,mBAAA,CAAAC,oBAAA,CAC/B,KAAM,CAAAC,WAAW,CAAG,KAAM,CAAA7C,UAAU,CAAC,CAAC,CACtC6B,UAAU,CAACgB,WAAW,CAAC,CACvBtB,gBAAgB,CACdsB,WAAW,SAAXA,WAAW,YAAAJ,kBAAA,CAAXI,WAAW,CAAEC,KAAK,UAAAL,kBAAA,WAAlBA,kBAAA,CAAoBM,MAAM,CACtB,CAAAF,WAAW,SAAXA,WAAW,kBAAAH,mBAAA,CAAXG,WAAW,CAAEC,KAAK,UAAAJ,mBAAA,iBAAlBA,mBAAA,CAAoBM,MAAM,CAAEC,IAAI,EAAKA,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEC,OAAO,CAAC,CAACC,EAAE,IACpDN,WAAW,SAAXA,WAAW,kBAAAF,mBAAA,CAAXE,WAAW,CAAEC,KAAK,UAAAH,mBAAA,kBAAAC,oBAAA,CAAlBD,mBAAA,CAAqB,CAAC,CAAC,UAAAC,oBAAA,iBAAvBA,oBAAA,CAAyBO,EAAE,EAC7B,IACN,CAAC,CACH,CAAC,CAEDb,SAAS,CAAC,CAAC,CACXE,YAAY,CAAC,CAAC,CAChB,CAAC,CAAE,CAACN,WAAW,CAAC,CAAC,CAEjBrC,SAAS,CAAC,IAAM,CACd,GAAI,CAACkB,YAAY,CAACI,GAAG,CAAC,eAAe,CAAC,CAAE,CACtCH,eAAe,CAAEoC,IAAI,EAAK,CACxBA,IAAI,CAACC,GAAG,CAAC,eAAe,CAAE,kBAAkB,CAAC,CAC7C,MAAO,CAAAD,IAAI,CACb,CAAC,CAAC,CACJ,CACF,CAAC,CAAE,EAAE,CAAC,CAENvD,SAAS,CAAC,IAAM,KAAAyD,cAAA,CAAAC,eAAA,CACd,KAAM,CAAAC,IAAI,CAAG,CACXC,SAAS,CAAErC,SAAS,CACpBsC,SAAS,CAAEtB,WAAW,CACtBuB,aAAa,CAAE5C,YAAY,CAACI,GAAG,CAAC,eAAe,CAAC,CAChDS,OAAO,CAAEA,OAAO,SAAPA,OAAO,kBAAA0B,cAAA,CAAP1B,OAAO,CAAEkB,KAAK,UAAAQ,cAAA,kBAAAC,eAAA,CAAdD,cAAA,CAAiB,CAAC,CAAC,UAAAC,eAAA,iBAAnBA,eAAA,CAAqBJ,EAAE,CAChCnB,KAAK,CAAEA,KACT,CAAC,CACDD,aAAa,CAACyB,IAAI,CAAC,CACrB,CAAC,CAAE,CACD5B,OAAO,SAAPA,OAAO,iBAAPA,OAAO,CAAEkB,KAAK,CACd7B,aAAa,CACbG,SAAS,CACTL,YAAY,CACZiB,KAAK,CACLI,WAAW,CACZ,CAAC,CAEFvC,SAAS,CAAC,IAAM,KAAA+D,eAAA,CAAAC,gBAAA,CACd,KAAM,CAAAL,IAAI,CAAG,CACXC,SAAS,CAAErC,SAAS,CACpBsC,SAAS,CAAEtB,WAAW,CACtBuB,aAAa,CAAE5C,YAAY,CAACI,GAAG,CAAC,eAAe,CAAC,CAChDS,OAAO,CAAEA,OAAO,SAAPA,OAAO,kBAAAgC,eAAA,CAAPhC,OAAO,CAAEkB,KAAK,UAAAc,eAAA,kBAAAC,gBAAA,CAAdD,eAAA,CAAiB,CAAC,CAAC,UAAAC,gBAAA,iBAAnBA,gBAAA,CAAqBV,EAAE,CAChCnB,KAAK,CAAEA,KACT,CAAC,CACDD,aAAa,CAACyB,IAAI,CAAC,CACnB,KAAM,CAAAM,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC7B,KAAM,CAAAC,SAAS,CAAG,KAAM,CAAA5D,YAAY,CAACqD,IAAI,CAAC,CAC1C7B,QAAQ,CAACoC,SAAS,CAAC,CACrB,CAAC,CACDD,UAAU,CAAC,CAAC,CACd,CAAC,CAAE,CAAClC,OAAO,SAAPA,OAAO,iBAAPA,OAAO,CAAEkB,KAAK,CAAE7B,aAAa,CAAEG,SAAS,CAAEL,YAAY,CAAEqB,WAAW,CAAC,CAAC,CAEzE,mBACEzB,KAAA,QACEqD,KAAK,CAAE,CACLC,OAAO,CAAE,MAAM,CACfC,GAAG,CAAE,MAAM,CACXC,cAAc,CAAE,QAAQ,CACxBC,QAAQ,CAAE,MAAM,CAChBC,UAAU,CAAE,SAAS,CACrBC,UAAU,CAAE,MAAM,CAClBC,aAAa,CAAE,OACjB,CAAE,CACFC,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAE7B9D,KAAA,QACEqD,KAAK,CAAE,CACLC,OAAO,CAAE,MAAM,CACfS,aAAa,CAAE,QAAQ,CACvBR,GAAG,CAAE,MAAM,CACXS,IAAI,CAAE,CACR,CAAE,CAAAF,QAAA,eAEFhE,IAAA,OAAIuD,KAAK,CAAE,CAAEY,QAAQ,CAAE,MAAM,CAAEC,UAAU,CAAE,KAAM,CAAE,CAAAJ,QAAA,CAAC,eAAa,CAAI,CAAC,cAEtE9D,KAAA,CAACL,GAAG,EACFwE,EAAE,CAAE,CACFC,eAAe,CAAE,MAAM,CACvBC,OAAO,CAAE,MAAM,CACfC,YAAY,CAAE,MAChB,CAAE,CAAAR,QAAA,EAED,GAAG,CACHjD,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAE0D,GAAG,CAAEjC,IAAI,eACdxC,IAAA,CAACF,uBAAuB,EAAC0C,IAAI,CAAEA,IAAK,EAAMA,IAAI,CAACE,EAAK,CACrD,CAAC,EACC,CAAC,cACN1C,IAAA,CAACJ,cAAc,EACbuB,OAAO,CAAEA,OAAQ,CACjBN,aAAa,CAAEA,aAAc,CAC7BC,gBAAgB,CAAEA,gBAAiB,CACnCS,KAAK,CAAEA,KAAM,CACbC,QAAQ,CAAEA,QAAS,CACnBC,WAAW,CAAEA,WAAY,CACzBC,cAAc,CAAEA,cAAe,CAChC,CAAC,EACC,CAAC,cAEN1B,IAAA,CAACL,cAAc,EACbwB,OAAO,CAAEA,OAAQ,CACjBN,aAAa,CAAEA,aAAc,CAC7BnB,YAAY,CAAEuB,KAAM,CACpByD,aAAa,CAAE/D,SAAU,CACzBgE,gBAAgB,CAAE/D,YAAa,CAC/Be,WAAW,CAAEA,WAAY,CACzBN,UAAU,CAAEA,UAAW,CACvBO,cAAc,CAAEA,cAAe,CAChC,CAAC,EACC,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}